<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>나의 아픈 곳은? - AI 건강 가이드 (상세 버전)</title>

    <style>
        /* CSS 코드 시작 */
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap');

        :root {
            --primary-color: #007bff;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --border-color: #dee2e6;
            --selected-color: #28a745;
            --hover-color: rgba(0, 123, 255, 0.4);
        }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--light-gray);
            color: var(--dark-gray);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 600px;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        h1 .subtitle {
            display: block;
            font-size: 1rem;
            color: #6c757d;
            font-weight: 400;
        }

        h2 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
            margin-top: 30px;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        h2 .step-subtitle {
            font-size: 1rem;
            color: #6c757d;
            font-weight: 400;
            margin-left: 10px;
        }

        .disclaimer {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 8px;
            padding: 15px;
            font-size: 0.9rem;
            text-align: center;
            margin: 20px 0;
        }

        .options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .btn {
            padding: 12px 20px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: white;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            font-family: 'Noto Sans KR', sans-serif;
            min-width: 80px;
            text-align: center;
        }

        .btn:hover {
            background-color: #e9ecef;
            border-color: #adb5bd;
        }

        .btn.selected {
            background-color: var(--selected-color);
            color: white;
            border-color: var(--selected-color);
            font-weight: 700;
        }

        .btn-next {
            width: 100%;
            background-color: var(--primary-color);
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            margin-top: 10px;
        }

        .btn-next:hover {
            opacity: 0.9;
            background-color: var(--primary-color);
        }

        .btn-back {
            background-color: #6c757d;
            color: white;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            height: 80px;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-family: 'Noto Sans KR', sans-serif;
            font-size: 1rem;
            resize: vertical;
        }

        .hidden {
            display: none;
        }

        .result-box {
            background-color: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .result-box h3 {
            margin-top: 0;
            color: var(--primary-color);
        }

        .result-box p {
            line-height: 1.7;
        }

        .result-box .warning {
            color: #856404;
            background-color: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 5px solid #ffeeba;
        }

        #body-image-container {
            position: relative;
            max-width: 300px;
            /* 이미지 크기 조절 */
            margin: 20px auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
        }

        #body-svg {
            width: 100%;
            height: auto;
            transition: all 0.5s ease-in-out;
        }

        .clickable-group,
        .clickable-part {
            fill: rgba(0, 123, 255, 0.01);
            /* 기본적으로 거의 투명 */
            stroke: rgba(0, 123, 255, 0.5);
            stroke-width: 8px;
            transition: fill 0.2s ease-in-out;
            cursor: pointer;
        }

        .clickable-group:hover,
        .clickable-part:hover {
            fill: var(--hover-color);
        }

        /* CSS 코드 끝 */
    </style>
</head>

<body>

    <div class="container">
        <h1>나의 아픈 곳은? <span class="subtitle">AI 건강 가이드</span></h1>

        <p class="disclaimer">
            ⚠️ <strong>중요 안내:</strong> 본 프로그램은 의료적 진단이 아니며, 참고용으로만 사용해야 합니다.
            심각하거나 지속적인 증상은 반드시 의사 또는 약사와 상담하세요.
        </p>

        <section id="step1_gender">
            <h2>1단계: 성별을 선택하세요</h2>
            <div class="options">
                <button class="btn gender-btn" data-gender="male">남성</button>
                <button class="btn gender-btn" data-gender="female">여성</button>
            </div>
        </section>

        <section id="step2_bodypart" class="hidden">
            <div id="level1-view">
                <h2>2단계: 아픈 부위의 그룹을 선택하세요</h2>
            </div>
            <div id="level2-view" class="hidden">
                <h2>2단계<span class="step-subtitle">(상세)</span>: 더 자세한 부위를 선택하세요</h2>
                <button id="back-to-fullbody" class="btn btn-back">전신 보기로 돌아가기</button>
            </div>

            <div id="body-image-container">
                <object type="image/svg+xml" data="front-full-body.svg" id="full-body-svg" style="width: 100%; height: auto;">
                    <img src="front-full-body.png" alt="인체 전면 이미지">
                </object>
            </div>
        </section>

        <section id="step3_symptoms" class="hidden">
            <h2>3단계: 증상을 모두 선택하세요 🤒</h2>
            <div id="symptom-options" class="options"></div>
            <textarea id="symptom-details" placeholder="선택지에 없는 증상이나 더 자세한 내용을 입력하세요."></textarea>
            <button id="to-step4-btn" class="btn btn-next">다음 단계로</button>
        </section>

        <section id="step4_conditions" class="hidden">
            <h2>4단계: 증상이 나타나기 전 상황을 알려주세요 ✍️</h2>
            <div class="options">
                <button class="btn condition-btn" data-condition="수면 부족">수면 부족</button>
                <button class="btn condition-btn" data-condition="스트레스">스트레스</button>
                <button class="btn condition-btn" data-condition="과식">과식</button>
                <button class="btn condition-btn" data-condition="과음">과음</button>
                <button class="btn condition-btn" data-condition="운동 후">운동/활동 후</button>
                <button class="btn condition-btn" data-condition="자고 일어난 후">자고 일어난 후</button>
            </div>
            <button id="get-result-btn" class="btn btn-next">AI 분석 결과 보기</button>
        </section>

        <section id="result" class="hidden">
            <h2>AI 분석 및 맞춤형 조언</h2>
            <div id="result-content" class="result-box"></div>
            <button id="restart-btn" class="btn btn-next">처음부터 다시 시작</button>
        </section>
    </div>

    <script>
        // JavaScript 코드 시작
        document.addEventListener('DOMContentLoaded', () => {
            const steps = {
                gender: document.getElementById('step1_gender'),
                bodyPart: document.getElementById('step2_bodypart'),
                symptoms: document.getElementById('step3_symptoms'),
                conditions: document.getElementById('step4_conditions'),
                result: document.getElementById('result')
            };

            let userSelections = { gender: null, part: null, symptoms: [], conditions: [] };

            const symptomsData = {
                // 머리 상세
                eye: ['눈 통증', '뻑뻑함', '충혈', '시야 흐림'],
                nose: ['코막힘', '콧물', '재채기'],
                mouth: ['목아픔', '기침', '혓바늘'],
                // 몸통 상세
                neck: ['목 뻐근함', '담 결림', '움직일 때 통증'],
                chest: ['가슴 통증', '답답함', '두근거림', '숨참'],
                stomach: ['속쓰림', '더부룩함', '설사', '변비'],
                back: ['등/허리 통증', '결림', '뻐근함'],
                // 팔 상세
                shoulder: ['어깨 결림', '팔 올릴때 통증', '뻐근함'],
                elbow: ['팔꿈치 통증', '팔을 굽힐때 통증'],
                hand: ['손목 통증', '손가락 저림', '손가락 관절염'],
                // 다리 상세
                hip: ['고관절 통증', '엉덩이 통증', '골반 통증'],
                knee: ['무릎 통증', '시큰거림', '계단 오를때 통증'],
                foot: ['발목 통증', '발바닥 통증', '발가락 저림'],
            };

            const svg = document.getElementById('body-svg');
            const initialViewBox = "0 0 380 803";
            const detailedViewBoxes = {
                head: "130 0 120 100",
                torso: "70 60 240 380",
                arms: "-20 130 420 250",
                legs: "30 430 320 380"
            };

            const level1Groups = document.getElementById('level1-groups');
            const level2Parts = document.getElementById('level2-parts');
            const level1View = document.getElementById('level1-view');
            const level2View = document.getElementById('level2-view');

            // --- 이벤트 리스너 설정 ---

            // 1단계: 성별 선택
            document.querySelectorAll('.gender-btn').forEach(button => {
                button.addEventListener('click', () => {
                    userSelections.gender = button.dataset.gender;
                    steps.gender.classList.add('hidden');
                    steps.bodyPart.classList.remove('hidden');
                });
            });

            // 2-1단계: 그룹 선택
            level1Groups.querySelectorAll('.clickable-group').forEach(group => {
                group.addEventListener('click', (e) => {
                    const groupName = e.currentTarget.dataset.group;
                    showDetailedView(groupName);
                });
            });

            // 2-2단계: 상세 부위 선택
            level2Parts.querySelectorAll('.clickable-part').forEach(part => {
                part.addEventListener('click', (e) => {
                    const partName = e.currentTarget.dataset.part;
                    userSelections.part = partName;
                    populateSymptoms(partName);
                    steps.bodyPart.classList.add('hidden');
                    steps.symptoms.classList.remove('hidden');
                });
            });

            // '전신 보기' 버튼
            document.getElementById('back-to-fullbody').addEventListener('click', showFullBodyView);

            // 3단계 -> 4단계
            document.getElementById('to-step4-btn').addEventListener('click', () => {
                userSelections.symptoms = [];
                document.querySelectorAll('.symptom-btn.selected').forEach(btn => {
                    userSelections.symptoms.push(btn.dataset.symptom);
                });
                const details = document.getElementById('symptom-details').value;
                if (details) userSelections.symptoms.push(`(상세: ${details})`);

                steps.symptoms.classList.add('hidden');
                steps.conditions.classList.remove('hidden');
            });

            // 4단계 -> 결과
            document.getElementById('get-result-btn').addEventListener('click', () => {
                userSelections.conditions = [];
                document.querySelectorAll('.condition-btn.selected').forEach(btn => {
                    userSelections.conditions.push(btn.dataset.condition);
                });
                analyzeAndShowResult();
                steps.conditions.classList.add('hidden');
                steps.result.classList.remove('hidden');
            });

            // 재시작
            document.getElementById('restart-btn').addEventListener('click', () => {
                userSelections = { gender: null, part: null, symptoms: [], conditions: [] };
                document.querySelectorAll('.btn.selected').forEach(btn => btn.classList.remove('selected'));
                document.getElementById('symptom-details').value = '';
                showFullBodyView();
                Object.values(steps).forEach(step => step.classList.add('hidden'));
                steps.gender.classList.remove('hidden');
            });

            // --- 핵심 함수 ---

            function showDetailedView(groupName) {
                level1View.classList.add('hidden');
                level2View.classList.remove('hidden');
                level1Groups.classList.add('hidden');
                level2Parts.classList.remove('hidden');

                svg.setAttribute('viewBox', detailedViewBoxes[groupName]);

                // 해당 그룹의 상세 부위만 보여주기
                level2Parts.querySelectorAll('.clickable-part').forEach(part => {
                    if (part.dataset.group === groupName) {
                        part.classList.remove('hidden');
                    } else {
                        part.classList.add('hidden');
                    }
                });
            }

            function showFullBodyView() {
                level2View.classList.add('hidden');
                level1View.classList.remove('hidden');
                level2Parts.classList.add('hidden');
                level1Groups.classList.remove('hidden');
                svg.setAttribute('viewBox', initialViewBox);
            }

            function populateSymptoms(partName) {
                const symptomOptionsContainer = document.getElementById('symptom-options');
                symptomOptionsContainer.innerHTML = '';
                const symptoms = symptomsData[partName] || [];
                symptoms.forEach(symptom => {
                    const button = document.createElement('button');
                    button.className = 'btn symptom-btn';
                    button.dataset.symptom = symptom;
                    button.textContent = symptom;
                    symptomOptionsContainer.appendChild(button);
                });
            }

            function analyzeAndShowResult() {
                const { part, symptoms, conditions, gender } = userSelections;
                const resultContent = document.getElementById('result-content');
                let html = '';
                const genderText = gender === 'male' ? '남성' : '여성';

                if (part === 'shoulder' && symptoms.includes('어깨 결림') && conditions.includes('스트레스')) {
                    html = `<h3>예상 원인</h3><p>${genderText} 사용자님 정보를 종합하면 <strong>스트레스와 장시간 같은 자세</strong>로 인한 <strong>어깨 근육 뭉침(근막통 증후군)</strong>일 수 있습니다.</p><h3>권장 조치</h3><p>- 온찜질과 함께 가벼운 어깨 스트레칭이 도움이 됩니다.<br>- 주기적으로 자세를 바꿔주고 휴식을 취하는 것이 중요합니다.</p><p class="warning"><strong>주의:</strong> 팔 저림이 동반되거나 통증이 심해 잠을 자기 어렵다면 병원 진료를 받으세요.</p>`;
                }
                else if (part === 'knee' && symptoms.includes('무릎 통증') && conditions.includes('운동/활동 후')) {
                    html = `<h3>예상 원인</h3><p><strong>무리한 운동이나 활동</strong>으로 인한 <strong>무릎 관절의 일시적인 염좌 또는 연골 자극</strong>일 수 있습니다.</p><h3>권장 조치</h3><p>- 무릎 사용을 최소화하고 1~2일간 냉찜질을 하는 것이 좋습니다.<br>- 붓기가 가라앉으면 온찜질로 전환하고, 무리하지 않는 선에서 부드럽게 움직여주세요.</p><p class="warning"><strong>주의:</strong> 무릎이 심하게 붓거나, 구부리고 펴기 어렵거나, '뚝'하는 파열음이 들렸다면 즉시 정형외과 진료를 권장합니다.</p>`;
                }
                else {
                    html = `<h3>분석 결과</h3><p>입력해주신 정보만으로는 명확한 원인을 파악하기 어렵습니다. 증상이 가볍다면 충분한 휴식을 취하며 경과를 지켜보시고, 불편함이 계속된다면 전문가의 진료를 받아보시는 것이 가장 좋습니다.</p><h3>기본 조언</h3><p>- 충분한 휴식과 수면<br>- 균형 잡힌 식사<br>- 가벼운 스트레칭</p><p class="warning"><strong>기억하세요:</strong> 이 프로그램은 참고용이며, 정확한 진단은 반드시 의사에게 받아야 합니다.</p>`;
                }
                resultContent.innerHTML = html;
            }
        });
        // JavaScript 코드 끝
    </script>
</body>

</html>